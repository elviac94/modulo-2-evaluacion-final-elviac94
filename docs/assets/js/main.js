"use strict";const inputName=document.querySelector("#main__input"),searchButton=document.querySelector("#button-search"),ulList=document.querySelector(".main__list"),favList=document.querySelector(".aside__list"),URL="https://api.tvmaze.com/search/shows?q=",placeholderURL="https://via.placeholder.com/210x295/ffffff/666666/?";let seriesTV=null,seriesFound=readFoundLocalStorage();const favSeries=readFavsLocalStorage();function getSerieName(){fetch(`https://api.tvmaze.com/search/shows?q=${inputName.value}`).then(e=>e.json()).then(e=>{seriesTV=e;for(let t of e)seriesFound.push(t);showSerieList(seriesTV)})}function showSerieList(e){let t="";for(const i of e){let e="";-1!==favSeries.indexOf(i.show.id.toString())&&(e="fav"),null!==i.show.image?t+=`<li class="${e}" id="${i.show.id}"><p>${i.show.name}</p><img src=${i.show.image.medium}>`:t+=`<li class="${e}" id="${i.show.id}"><p>${i.show.name}</p><img src=${placeholderURL}>`}ulList.innerHTML=t,addSerieLiListener()}function addSerieLiListener(){const e=document.querySelectorAll(".main__list li");for(const t of e)t.addEventListener("click",onclickLi)}function onclickLi(e){addFavSeries(e.currentTarget.id),addFavLocalStorage(),addSeriesFoundLocalStorage(),showFavSeries()}function addFavSeries(e){-1===favSeries.indexOf(e)&&favSeries.push(e)}function getSerieObject(e){return seriesFound.find(t=>t.show.id===parseInt(e))}function showFavSeries(){favList.innerHTML="";for(const e of favSeries){const t=getSerieObject(e);if(e==t.show.id){let e=document.createElement("li"),i=document.createElement("button"),a=document.createElement("p"),o=document.createElement("img");null!==t.show.image?o.setAttribute("src",`${t.show.image.medium}`):o.setAttribute("src",`${placeholderURL}`),e.setAttribute("id",`${t.show.id}`),a.innerText=`${t.show.name}`,i.innerText="X",e.appendChild(i),e.appendChild(a),e.appendChild(o),favList.appendChild(e),i.addEventListener("click",onClickFav)}}const e=document.createElement("button");e.innerText="Borrar",favList.appendChild(e),e.addEventListener("click",removeAllFav)}function addFavLocalStorage(){localStorage.setItem("favourites",JSON.stringify(favSeries))}function addSeriesFoundLocalStorage(){localStorage.setItem("seriesFound",JSON.stringify(seriesFound))}function readFavsLocalStorage(){let e=JSON.parse(localStorage.getItem("favourites"));return null!==e?e:[]}function readFoundLocalStorage(){let e=JSON.parse(localStorage.getItem("seriesFound"));return null!==e?e:[]}function onClickFav(e){removeFavSeries(e.currentTarget.parentElement.id),addFavLocalStorage(),showFavSeries()}function removeFavSeries(e){const t=favSeries.indexOf(e);favSeries.splice(t,1)}function removeAllFav(){favSeries.splice(0,favSeries.length),addFavLocalStorage(),showFavSeries()}showFavSeries(),searchButton.addEventListener("click",getSerieName);